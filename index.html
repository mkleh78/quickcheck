<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Altersvorsorge-Tool für Selbständige</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.5;
        }
        .container {
            max-width: 1024px;
            margin: 0 auto;
            padding: 1rem;
        }
        .header {
            background-color: #001d6c;
            color: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            margin-bottom: 2rem;
        }
        .header h1 {
            font-size: 1.875rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        .header p {
            font-size: 1.125rem;
        }

        /* Card Styles */
        .card {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        /* Form Styles */
        .progress-container {
            margin-bottom: 2rem;
        }
        .progress-bar {
            width: 100%;
            height: 0.625rem;
            background-color: #e5e7eb;
            border-radius: 9999px;
            overflow: hidden;
        }
        .progress-bar-fill {
            height: 100%;
            background-color: #001d6c;
            border-radius: 9999px;
            transition: width 0.3s ease;
        }
        .progress-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }
        .section-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #001d6c;
            margin-bottom: 1.5rem;
        }

        .collapsible-section {
            margin-bottom: 1.5rem;
        }
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            background-color: #e6f0ff;
            padding: 0.75rem;
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .section-header h3 {
            display: flex;
            align-items: center;
            font-weight: bold;
            color: #001d6c;
        }
        .section-header h3 i {
            margin-right: 0.5rem;
        }
        .section-content {
            padding: 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            display: none;
        }
        .section-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 1rem;
        }
        .form-label {
            display: flex;
            align-items: center;
            margin-bottom: 0.25rem;
            font-weight: 500;
            color: #4b5563;
        }
        .form-label i.help {
            margin-left: 0.5rem;
            color: #001d6c;
            cursor: help;
            position: relative;
        }
        .tooltip {
            position: absolute;
            left: 1.5rem;
            top: 0;
            padding: 0.5rem;
            background-color: #001d6c;
            color: white;
            font-size: 0.875rem;
            border-radius: 0.25rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            width: 16rem;
            z-index: 10;
            display: none;
        }
        .form-input, .form-select {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.25rem;
            transition: all 0.2s;
        }
        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: transparent;
            box-shadow: 0 0 0 2px #001d6c;
        }
        .form-input.error, .form-select.error {
            border-color: #ef4444;
        }
        .form-input.error:focus, .form-select.error:focus {
            box-shadow: 0 0 0 2px #ef4444;
        }
        .form-checkbox {
            height: 1rem;
            width: 1rem;
            margin-right: 0.5rem;
            cursor: pointer;
        }
        .error-message {
            color: #ef4444;
            font-size: 0.75rem;
            margin-top: 0.25rem;
            display: flex;
            align-items: center;
        }
        .error-message i {
            margin-right: 0.25rem;
        }
        .help-text {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }
        .checkbox-group {
            margin-top: 0.5rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .checkbox-label {
            display: flex;
            align-items: center;
        }

        /* Button Styles */
        .buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
        }
        .btn {
            padding: 0.5rem 1.5rem;
            border-radius: 0.375rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .btn-primary {
            background-color: #001d6c;
            color: white;
            border: none;
        }
        .btn-primary:hover {
            background-color: #001a58;
        }
        .btn-secondary {
            background-color: transparent;
            color: #001d6c;
            border: 1px solid #001d6c;
        }
        .btn-secondary:hover {
            background-color: #e6f0ff;
        }
        .btn-right {
            margin-left: auto;
        }

        /* Results Styles */
        .results-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        @media (min-width: 768px) {
            .results-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        .result-panel {
            padding: 1rem;
            border-radius: 0.5rem;
        }
        .panel-blue {
            background-color: #e6f0ff;
        }
        .panel-orange {
            background-color: #fff7ed;
        }
        .panel-title {
            font-weight: bold;
            color: #001d6c;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
        }
        .panel-title i {
            margin-right: 0.5rem;
        }
        .result-list {
            list-style: none;
            margin-top: 0.5rem;
        }
        .result-list li {
            display: flex;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }
        .result-list li i {
            color: #22c55e;
            margin-right: 0.5rem;
            margin-top: 0.25rem;
            flex-shrink: 0;
        }
        .result-row {
            margin-bottom: 1rem;
        }
        .highlight {
            color: #ea580c;
            font-weight: bold;
        }
        .progress-score {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }
        .score-bar {
            flex-grow: 1;
            height: 1rem;
            background-color: #e5e7eb;
            border-radius: 9999px;
            overflow: hidden;
            margin-right: 0.5rem;
        }
        .score-fill {
            height: 100%;
            background-color: #001d6c;
            border-radius: 9999px;
        }
        .strategy-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-top: 1rem;
        }
        @media (min-width: 640px) {
            .strategy-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        @media (min-width: 768px) {
            .strategy-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        .strategy-item {
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
        }
        .strategy-title {
            font-weight: 500;
            color: #001d6c;
            margin-bottom: 0.5rem;
        }
        .strategy-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        .badge-green {
            background-color: #dcfce7;
            color: #166534;
        }
        .badge-yellow {
            background-color: #fef9c3;
            color: #854d0e;
        }
        .badge-red {
            background-color: #fee2e2;
            color: #991b1b;
        }
        .badge-gray {
            background-color: #f3f4f6;
            color: #374151;
        }
        .recommendations {
            background-color: #e6f0ff;
            padding: 1.5rem;
            border-radius: 0.5rem;
            margin-top: 1.5rem;
        }
        .recommendations h3 {
            font-size: 1.25rem;
            font-weight: bold;
            color: #001d6c;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }
        .recommendations h3 i {
            margin-right: 0.5rem;
        }
        .recommendation-list {
            list-style: none;
        }
        .recommendation-list li {
            display: flex;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        .recommendation-list li i {
            color: #ea580c;
            margin-right: 0.5rem;
            margin-top: 0.25rem;
            flex-shrink: 0;
        }

        /* Footer Styles */
        .footer {
            text-align: center;
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 2rem;
        }
        .footer p + p {
            margin-top: 0.25rem;
        }

        /* Hide/Show Functionality */
        .step-content {
            display: none;
        }
        .step-content.active {
            display: block;
        }
        #results-container {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Altersvorsorge-Check für Selbständige</h1>
            <p>Machen Sie eine Bestandsaufnahme Ihrer Altersvorsorge und erhalten Sie individuelle Empfehlungen</p>
        </div>

        <div id="form-container" class="card">
            <div class="progress-container">
                <div class="progress-labels">
                    <span class="text-sm font-medium">Fortschritt</span>
                    <span class="text-sm font-medium" id="progress-percentage">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-bar-fill" id="progress-bar-fill" style="width: 0%"></div>
                </div>
            </div>

            <form id="altersvorsorge-form">
                <!-- Step 1: Bestehende Altersvorsorge -->
                <div class="step-content active" id="step-1">
                    <h2 class="section-title">1. Bestehende Altersvorsorge prüfen</h2>
                    
                    <!-- Gesetzliche Rentenversicherung -->
                    <div class="collapsible-section">
                        <div class="section-header" data-section="gesetzlich">
                            <h3><i class="fas fa-building"></i> Gesetzliche Rentenversicherung</h3>
                            <i class="fas fa-chevron-up"></i>
                        </div>
                        <div class="section-content active" id="section-gesetzlich">
                            <div class="form-group">
                                <div class="form-label">
                                    <label for="versicherungsArt">Art der Versicherung</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Gibt an, ob Sie in die gesetzliche Rentenversicherung einzahlen und in welcher Form."></i>
                                    <div class="tooltip"></div>
                                </div>
                                <select id="versicherungsArt" name="versicherungsArt" class="form-select">
                                    <option value="">Bitte wählen</option>
                                    <option value="Pflichtversichert">Pflichtversichert</option>
                                    <option value="Freiwillig versichert">Freiwillig versichert</option>
                                    <option value="Nicht versichert">Nicht versichert</option>
                                </select>
                                <div class="error-message" id="error-versicherungsArt" style="display: none;">
                                    <i class="fas fa-exclamation-circle"></i> Bitte wählen Sie die Art der Versicherung aus
                                </div>
                                <div class="help-text">Pflichtversichert = z.B. als Handwerker, freiwillig = eigene Einzahlung, nicht versichert = keine Beiträge</div>
                            </div>
                            <div class="form-group">
                                <div class="form-label">
                                    <label for="rentenHöhe">Bisher erworbene Rente (€/Monat)</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Die bisher von Ihnen erworbene monatliche Rente laut Ihrer Renteninformation der Deutschen Rentenversicherung."></i>
                                </div>
                                <input type="number" id="rentenHöhe" name="rentenHöhe" class="form-input" placeholder="0" min="0" step="10">
                                <div class="help-text">Zu finden in Ihrer Renteninformation der DRV</div>
                            </div>
                            <div class="form-group">
                                <div class="checkbox-label">
                                    <input type="checkbox" id="freiwilligeEinzahlung" name="freiwilligeEinzahlung" class="form-checkbox">
                                    <label for="freiwilligeEinzahlung">Freiwillige Einzahlung in Betracht gezogen</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Selbständige können freiwillig in die gesetzliche Rentenversicherung einzahlen, um Rentenansprüche zu erwerben."></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Private Altersvorsorge -->
                    <div class="collapsible-section">
                        <div class="section-header" data-section="privat">
                            <h3><i class="fas fa-dollar-sign"></i> Private Altersvorsorge</h3>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="section-content" id="section-privat">
                            <div class="form-group">
                                <div class="checkbox-label">
                                    <input type="checkbox" id="privateRente" name="privateRente" class="form-checkbox">
                                    <label for="privateRente">Private Rentenversicherung vorhanden</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Private Rentenversicherungen sind Vorsorgeverträge, die eine lebenslange Rente im Alter garantieren."></i>
                                </div>
                            </div>
                            
                            <div id="privateRenteDetails" style="display: none;">
                                <div class="form-group">
                                    <div class="form-label">
                                        <label for="privateRenteVerzinsung">Garantierte Verzinsung (%)</label>
                                        <i class="fas fa-question-circle help" data-tooltip="Der garantierte Zinssatz, mit dem Ihr Kapital in der privaten Rentenversicherung verzinst wird."></i>
                                    </div>
                                    <input type="number" id="privateRenteVerzinsung" name="privateRenteVerzinsung" class="form-input" placeholder="0" min="0" step="0.1">
                                    <div class="help-text">Der in Ihrem Vertrag garantierte Zinssatz (meist zwischen 0,25% und 3,5%)</div>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">
                                        <label for="privateRenteKosten">Jährliche Kosten (%)</label>
                                        <i class="fas fa-question-circle help" data-tooltip="Die jährlichen Verwaltungs- und Abschlusskosten der privaten Rentenversicherung in Prozent."></i>
                                    </div>
                                    <input type="number" id="privateRenteKosten" name="privateRenteKosten" class="form-input" placeholder="0" min="0" step="0.1">
                                    <div class="help-text">Gesamtkosten inkl. Abschluss- und Verwaltungskosten (meist zwischen 1,5% und 3%)</div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <div class="checkbox-label">
                                    <input type="checkbox" id="etfSparpläne" name="etfSparpläne" class="form-checkbox">
                                    <label for="etfSparpläne">ETF-/Fonds-Sparpläne vorhanden</label>
                                    <i class="fas fa-question-circle help" data-tooltip="ETF-Sparpläne investieren regelmäßig in börsengehandelte Indexfonds und bieten Renditechancen bei höherem Risiko."></i>
                                </div>
                            </div>
                            
                            <div id="etfDetails" style="display: none;">
                                <div class="form-group">
                                    <div class="form-label">
                                        <label for="etfSparplanBetrag">Monatlicher Sparbetrag (€)</label>
                                        <i class="fas fa-question-circle help" data-tooltip="Der monatliche Betrag, den Sie in ETF- oder Fondssparpläne investieren."></i>
                                    </div>
                                    <input type="number" id="etfSparplanBetrag" name="etfSparplanBetrag" class="form-input" placeholder="0" min="0" step="10">
                                    <div class="error-message" id="error-etfSparplanBetrag" style="display: none;">
                                        <i class="fas fa-exclamation-circle"></i> Bitte geben Sie einen gültigen Betrag ein
                                    </div>
                                    <div class="help-text">Gesamtbetrag aller regelmäßigen Sparplanraten</div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <div class="checkbox-label">
                                    <input type="checkbox" id="rürupRente" name="rürupRente" class="form-checkbox">
                                    <label for="rürupRente">Rürup-Rente (Basisrente) vorhanden</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Die Basisrente (Rürup) ist eine staatlich geförderte private Altersvorsorge für Selbständige mit steuerlichen Vorteilen."></i>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <div class="checkbox-label">
                                    <input type="checkbox" id="riesterRente" name="riesterRente" class="form-checkbox">
                                    <label for="riesterRente">Riester-Rente vorhanden</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Die Riester-Rente ist eine staatlich geförderte private Altersvorsorge mit Zulagen und Steuervorteilen."></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Betriebliche Altersvorsorge -->
                    <div class="collapsible-section">
                        <div class="section-header" data-section="betrieblich">
                            <h3><i class="fas fa-building"></i> Betriebliche Altersvorsorge</h3>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="section-content" id="section-betrieblich">
                            <p class="help-text mb-4">Falls relevant für Ihre Situation als Selbständige/r:</p>
                            
                            <div class="form-group">
                                <div class="checkbox-label">
                                    <input type="checkbox" id="direktversicherung" name="direktversicherung" class="form-checkbox">
                                    <label for="direktversicherung">Direktversicherung über eigene Firma</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Eine Direktversicherung ist eine betriebliche Altersvorsorge, die der Arbeitgeber für den Arbeitnehmer abschließt."></i>
                                </div>
                                <div class="help-text">Eine Lebensversicherung, die über Ihre GmbH oder UG abgeschlossen wurde</div>
                            </div>
                            
                            <div class="form-group">
                                <div class="checkbox-label">
                                    <input type="checkbox" id="unterstützungskasse" name="unterstützungskasse" class="form-checkbox">
                                    <label for="unterstützungskasse">Unterstützungskasse über eigene Firma</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Die Unterstützungskasse ist eine Form der betrieblichen Altersvorsorge für Geschäftsführer oder leitende Angestellte."></i>
                                </div>
                                <div class="help-text">Eine Versorgungseinrichtung für Geschäftsführer oder leitende Angestellte</div>
                            </div>
                            
                            <div class="form-group">
                                <div class="checkbox-label">
                                    <input type="checkbox" id="pensionskasse" name="pensionskasse" class="form-checkbox">
                                    <label for="pensionskasse">Pensionskasse</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Eine Pensionskasse ist ein Versorgungswerk, das Betriebsrenten für die Mitarbeiter von Unternehmen verwaltet."></i>
                                </div>
                                <div class="help-text">Mitglied in einer branchenspezifischen Pensionskasse</div>
                            </div>
                            
                            <div class="form-group">
                                <div class="checkbox-label">
                                    <input type="checkbox" id="versorgungswerk" name="versorgungswerk" class="form-checkbox">
                                    <label for="versorgungswerk">Versorgungswerk</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Versorgungswerke sind berufsständische Organisationen, die die Altersvorsorge für bestimmte Berufsgruppen übernehmen."></i>
                                </div>
                                <div class="help-text">Mitglied in einem berufsständischen Versorgungswerk (z.B. für Ärzte, Rechtsanwälte)</div>
                            </div>
                        </div>
                    </div>

                    <!-- Immobilien als Altersvorsorge -->
                    <div class="collapsible-section">
                        <div class="section-header" data-section="immobilien">
                            <h3><i class="fas fa-home"></i> Immobilien als Altersvorsorge</h3>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="section-content" id="section-immobilien">
                            <div class="form-group">
                                <div class="checkbox-label">
                                    <input type="checkbox" id="wohneigentum" name="wohneigentum" class="form-checkbox">
                                    <label for="wohneigentum">Selbstgenutztes Wohneigentum vorhanden</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Selbstgenutztes Wohneigentum kann im Alter für Mietersparnis sorgen und das verfügbare Einkommen erhöhen."></i>
                                </div>
                                <div class="help-text">Eigene Immobilie, in der Sie selbst wohnen</div>
                            </div>
                            
                            <div class="form-group">
                                <div class="checkbox-label">
                                    <input type="checkbox" id="vermietet" name="vermietet" class="form-checkbox">
                                    <label for="vermietet">Vermietete Immobilien vorhanden</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Vermietete Immobilien können im Alter einen zusätzlichen Einkommensstrom generieren."></i>
                                </div>
                                <div class="help-text">Immobilien, die Sie zur Kapitalanlage vermieten</div>
                            </div>
                            
                            <div id="immobilienDetails" style="display: none;">
                                <div class="form-group">
                                    <div class="form-label">
                                        <label for="immobilienWert">Geschätzter Gesamtwert der Immobilien (€)</label>
                                        <i class="fas fa-question-circle help" data-tooltip="Der aktuelle Marktwert Ihrer Immobilien, basierend auf vergleichbaren Objekten in Ihrer Region."></i>
                                    </div>
                                    <input type="number" id="immobilienWert" name="immobilienWert" class="form-input" placeholder="0" min="0" step="10000">
                                    <div class="error-message" id="error-immobilienWert" style="display: none;">
                                        <i class="fas fa-exclamation-circle"></i> Bitte geben Sie einen gültigen Immobilienwert ein
                                    </div>
                                    <div class="help-text">Aktueller Marktwert aller Immobilien zusammen</div>
                                </div>
                                
                                <div class="form-group">
                                    <div class="form-label">
                                        <label for="kredite">Höhe der laufenden Kredite (€)</label>
                                        <i class="fas fa-question-circle help" data-tooltip="Die Summe aller noch offenen Immobilienkredite und Hypotheken."></i>
                                    </div>
                                    <input type="number" id="kredite" name="kredite" class="form-input" placeholder="0" min="0" step="10000">
                                    <div class="help-text">Summe aller noch ausstehenden Immobilienkredite</div>
                                </div>
                                
                                <div id="mietrenditeGroup" class="form-group" style="display: none;">
                                    <div class="form-label">
                                        <label for="mietrendite">Mietrendite (% p.a.)</label>
                                        <i class="fas fa-question-circle help" data-tooltip="Die jährliche Rendite Ihrer vermieteten Immobilien, berechnet als (Jahresmiete - Kosten) / Immobilienwert * 100."></i>
                                    </div>
                                    <input type="number" id="mietrendite" name="mietrendite" class="form-input" placeholder="0" min="0" max="15" step="0.1">
                                    <div class="help-text">Jährliche Nettomieteinnahmen geteilt durch Immobilienwert mal 100</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Einnahmen & Steuerliche Situation -->
                <div class="step-content" id="step-2">
                    <h2 class="section-title">2. Einnahmen & Steuerliche Situation klären</h2>
                    
                    <div class="collapsible-section">
                        <div class="section-header" data-section="einnahmen">
                            <h3><i class="fas fa-chart-bar"></i> Einnahmen & Steuerliche Situation</h3>
                            <i class="fas fa-chevron-up"></i>
                        </div>
                        <div class="section-content active" id="section-einnahmen">
                            <div class="form-group">
                                <div class="form-label">
                                    <label for="jährlicheEinkünfte">Jährliche Einkünfte (€)</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Ihr zu versteuerndes Jahreseinkommen vor Steuern und Abgaben."></i>
                                </div>
                                <input type="number" id="jährlicheEinkünfte" name="jährlicheEinkünfte" class="form-input" placeholder="0" min="0" step="1000">
                                <div class="error-message" id="error-jährlicheEinkünfte" style="display: none;">
                                    <i class="fas fa-exclamation-circle"></i> Bitte geben Sie Ihre jährlichen Einkünfte an
                                </div>
                                <div class="help-text">Brutto-Gewinn aus Selbstständigkeit oder Gehalt bei eigener GmbH</div>
                            </div>
                            
                            <div class="form-group">
                                <div class="form-label">
                                    <label for="monatlicheRücklage">Monatliche Rücklage für Altersvorsorge (€)</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Der Betrag, den Sie monatlich für Ihre Altersvorsorge zurücklegen."></i>
                                </div>
                                <input type="number" id="monatlicheRücklage" name="monatlicheRücklage" class="form-input" placeholder="0" min="0" step="50">
                                <div class="error-message" id="error-monatlicheRücklage" style="display: none;">
                                    <i class="fas fa-exclamation-circle"></i> Bitte geben Sie Ihre monatliche Rücklage an
                                </div>
                                <div class="help-text">Richtwert: 10–30% des Einkommens</div>
                            </div>
                            
                            <div class="form-group">
                                <div class="form-label">
                                    <label>Steuerlich absetzbare Altersvorsorge</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Altersvorsorgeprodukte, die Sie steuerlich geltend machen können, um Ihre Steuerlast zu reduzieren."></i>
                                </div>
                                <div class="checkbox-group">
                                    <div class="checkbox-label">
                                        <input type="checkbox" id="steuer_rürup" name="steuerAbsetzung" value="Rürup-Rente" class="form-checkbox">
                                        <label for="steuer_rürup">Rürup-Rente</label>
                                    </div>
                                    <div class="checkbox-label">
                                        <input type="checkbox" id="steuer_drv" name="steuerAbsetzung" value="Freiwillige DRV-Einzahlungen" class="form-checkbox">
                                        <label for="steuer_drv">Freiwillige DRV-Einzahlungen</label>
                                    </div>
                                    <div class="checkbox-label">
                                        <input type="checkbox" id="steuer_bav" name="steuerAbsetzung" value="Betriebliche Altersvorsorge" class="form-checkbox">
                                        <label for="steuer_bav">Betriebliche Altersvorsorge</label>
                                    </div>
                                    <div class="checkbox-label">
                                        <input type="checkbox" id="steuer_prv" name="steuerAbsetzung" value="Private Rentenversicherung" class="form-checkbox">
                                        <label for="steuer_prv">Private Rentenversicherung</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <div class="checkbox-label">
                                    <input type="checkbox" id="höchstbeträgeAusgeschöpft" name="höchstbeträgeAusgeschöpft" class="form-checkbox">
                                    <label for="höchstbeträgeAusgeschöpft">Steuerliche Höchstbeträge bereits ausgeschöpft</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Sie können jährlich bis zu 27.566 € (Ledige) bzw. 55.132 € (Verheiratete) für Basisrente oder freiwillige DRV-Beiträge steuerlich absetzen."></i>
                                </div>
                                <div class="help-text">Für 2024: Rürup bis 27.566 € bei Ledigen, 55.132 € bei Verheirateten</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Rentenlücke berechnen -->
                <div class="step-content" id="step-3">
                    <h2 class="section-title">3. Rentenlücke berechnen</h2>
                    
                    <div class="collapsible-section">
                        <div class="section-header" data-section="rentenlücke">
                            <h3><i class="fas fa-chart-pie"></i> Rentenlücke berechnen</h3>
                            <i class="fas fa-chevron-up"></i>
                        </div>
                        <div class="section-content active" id="section-rentenlücke">
                            <div class="form-group">
                                <div class="form-label">
                                    <label for="geschätzteRente">Geschätzte monatliche Rente (gesetzlich + privat) in €</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Die voraussichtliche monatliche Rente aus allen Ihren Vorsorgebausteinen (gesetzlich, privat, betrieblich)."></i>
                                </div>
                                <input type="number" id="geschätzteRente" name="geschätzteRente" class="form-input" placeholder="0" min="0" step="50">
                                <div class="error-message" id="error-geschätzteRente" style="display: none;">
                                    <i class="fas fa-exclamation-circle"></i> Bitte geben Sie Ihre geschätzte monatliche Rente an
                                </div>
                                <div class="help-text">Nutzen Sie ggf. Online-Rechner wie den Finanztip Rentenrechner</div>
                            </div>
                            
                            <div class="form-group">
                                <div class="form-label">
                                    <label for="gewünschtesEinkommen">Gewünschtes monatliches Netto-Einkommen im Alter (€)</label>
                                    <i class="fas fa-question-circle help" data-tooltip="Das monatliche Nettoeinkommen, das Sie im Ruhestand zur Verfügung haben möchten."></i>
                                </div>
                                <input type="number" id="gewünschtesEinkommen" name="gewünschtesEinkommen" class="form-input" placeholder="0" min="0" step="100">
                                <div class="error-message" id="error-gewünschtesEinkommen" style="display: none;">
                                    <i class="fas fa-exclamation-circle"></i> Bitte geben Sie Ihr gewünschtes Einkommen im Alter an
                                </div>
                                <div class="help-text">Betrag, den Sie monatlich im Ruhestand zur Verfügung haben möchten</div>
                            </div>
                            
                            <div class="mt-4 p-4 bg-blue-50 rounded">
                                <p class="text-sm text-gray-700 mb-2">
                                    <strong>Faustregel zur Berechnung des benötigten Kapitals:</strong>
                                </p>
                                <p class="text-sm text-gray-700">
                                    Jährlicher Zusatzbedarf × 25 = benötigtes Kapital<br />
                                    Beispiel: 500 € monatliche Rentenlücke × 12 Monate × 25 = 150.000 € benötigtes Kapital
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="buttons">
                    <button type="button" id="btn-prev" class="btn btn-secondary" style="display: none;">Zurück</button>
                    <button type="button" id="btn-next" class="btn btn-primary btn-right">Weiter</button>
                </div>
            </form>
        </div>

        <!-- Results Section -->
        <div id="results-container" class="card">
            <h2 class="section-title">Ihre Altersvorsorge im Überblick</h2>
            
            <div class="results-grid">
                <div class="result-panel panel-blue">
                    <h3 class="panel-title">
                        <i class="fas fa-dollar-sign"></i>
                        Aktuelle Situation
                    </h3>
                    <ul class="result-list" id="situation-list">
                        <!-- Will be populated by JavaScript -->
                    </ul>
                </div>
                
                <div class="result-panel panel-orange">
                    <h3 class="panel-title">
                        <i class="fas fa-calculator"></i>
                        Rentenlücke
                    </h3>
                    <div id="gap-results">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
            
            <div>
                <h3 class="section-title">Ihre Altersvorsorgestrategie</h3>
                <div class="progress-score">
                    <div class="score-bar">
                        <div class="score-fill" id="score-fill" style="width: 0%"></div>
                    </div>
                    <span class="font-bold" id="score-percentage">0%</span>
                </div>
                
                <div class="strategy-grid" id="strategy-grid">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
            
            <div class="recommendations">
                <h3>
                    <i class="fas fa-lightbulb"></i>
                    Empfehlungen für Sie
                </h3>
                <ul class="recommendation-list" id="recommendation-list">
                    <!-- Will be populated by JavaScript -->
                </ul>
            </div>
            
            <button type="button" id="btn-restart" class="btn btn-primary" style="margin-top: 2rem;">
                Neue Berechnung starten
            </button>
        </div>

        <div class="footer">
            <p>© 2025 House of Finance & Tech Berlin | Alle Angaben ohne Gewähr</p>
            <p>Diese Analyse ersetzt keine professionelle Finanzberatung.</p>
        </div>
    </div>

    <script>
        // Form Data Object
        let formData = {
            // Gesetzliche Rentenversicherung
            versicherungsArt: '',
            rentenHöhe: '',
            freiwilligeEinzahlung: false,
            
            // Private Altersvorsorge
            privateRente: false,
            privateRenteVerzinsung: '',
            privateRenteKosten: '',
            etfSparpläne: false,
            etfSparplanBetrag: '',
            rürupRente: false,
            riesterRente: false,
            
            // Betriebliche Altersvorsorge
            direktversicherung: false,
            unterstützungskasse: false,
            pensionskasse: false,
            versorgungswerk: false,
            
            // Immobilien
            wohneigentum: false,
            vermietet: false,
            immobilienWert: '',
            kredite: '',
            mietrendite: '',
            
            // Einnahmen & Steuer
            jährlicheEinkünfte: '',
            monatlicheRücklage: '',
            steuerAbsetzung: [],
            höchstbeträgeAusgeschöpft: false,
            
            // Rentenlücke
            geschätzteRente: '',
            gewünschtesEinkommen: '',
            rentenlücke: 0,
            benötigtesKapital: 0
        };

        // Current step in the form
        let currentStep = 1;
        const totalSteps = 3;

        // DOM Elements
        const formContainer = document.getElementById('form-container');
        const resultsContainer = document.getElementById('results-container');
        const progressBar = document.getElementById('progress-bar-fill');
        const progressPercentage = document.getElementById('progress-percentage');
        const btnPrev = document.getElementById('btn-prev');
        const btnNext = document.getElementById('btn-next');
        const btnRestart = document.getElementById('btn-restart');

        // Tooltips
        const tooltipTriggers = document.querySelectorAll('.help');
        tooltipTriggers.forEach(trigger => {
            trigger.addEventListener('mouseenter', () => {
                const tooltip = trigger.nextElementSibling;
                if (tooltip && tooltip.classList.contains('tooltip')) {
                    tooltip.textContent = trigger.getAttribute('data-tooltip');
                    tooltip.style.display = 'block';
                }
            });

            trigger.addEventListener('mouseleave', () => {
                const tooltip = trigger.nextElementSibling;
                if (tooltip && tooltip.classList.contains('tooltip')) {
                    tooltip.style.display = 'none';
                }
            });
        });

        // Collapsible Sections
        const sectionHeaders = document.querySelectorAll('.section-header');
        sectionHeaders.forEach(header => {
            header.addEventListener('click', () => {
                const sectionId = header.getAttribute('data-section');
                const content = document.getElementById(`section-${sectionId}`);
                
                if (content.classList.contains('active')) {
                    content.classList.remove('active');
                    header.querySelector('i:last-child').classList.replace('fa-chevron-up', 'fa-chevron-down');
                } else {
                    content.classList.add('active');
                    header.querySelector('i:last-child').classList.replace('fa-chevron-down', 'fa-chevron-up');
                }
            });
        });

        // Form Input Handlers
        document.getElementById('privateRente').addEventListener('change', function() {
            document.getElementById('privateRenteDetails').style.display = this.checked ? 'block' : 'none';
            formData.privateRente = this.checked;
        });

        document.getElementById('etfSparpläne').addEventListener('change', function() {
            document.getElementById('etfDetails').style.display = this.checked ? 'block' : 'none';
            formData.etfSparpläne = this.checked;
        });

        document.getElementById('wohneigentum').addEventListener('change', function() {
            updateImmobilienDetails();
            formData.wohneigentum = this.checked;
        });

        document.getElementById('vermietet').addEventListener('change', function() {
            updateImmobilienDetails();
            document.getElementById('mietrenditeGroup').style.display = this.checked ? 'block' : 'none';
            formData.vermietet = this.checked;
        });

        function updateImmobilienDetails() {
            const wohneigentum = document.getElementById('wohneigentum').checked;
            const vermietet = document.getElementById('vermietet').checked;
            document.getElementById('immobilienDetails').style.display = (wohneigentum || vermietet) ? 'block' : 'none';
        }

        // Get checkbox values for steuerAbsetzung
        function updateSteuerAbsetzung() {
            const checkboxes = document.querySelectorAll('input[name="steuerAbsetzung"]:checked');
            formData.steuerAbsetzung = Array.from(checkboxes).map(cb => cb.value);
        }

        // Update progress bar
        function updateProgress() {
            const progress = ((currentStep - 1) / totalSteps) * 100;
            progressBar.style.width = `${progress}%`;
            progressPercentage.textContent = `${Math.round(progress)}%`;
        }

        // Form validation for each step
        function validateCurrentStep() {
            let isValid = true;
            const errors = {};

            if (currentStep === 1) {
                // Validate Step 1
                if (!formData.versicherungsArt) {
                    errors.versicherungsArt = true;
                    isValid = false;
                }

                if (formData.etfSparpläne && (!formData.etfSparplanBetrag || isNaN(parseFloat(formData.etfSparplanBetrag)))) {
                    errors.etfSparplanBetrag = true;
                    isValid = false;
                }

                if ((formData.wohneigentum || formData.vermietet) && (!formData.immobilienWert || isNaN(parseFloat(formData.immobilienWert)))) {
                    errors.immobilienWert = true;
                    isValid = false;
                }
            } else if (currentStep === 2) {
                // Validate Step 2
                if (!formData.jährlicheEinkünfte || isNaN(parseFloat(formData.jährlicheEinkünfte))) {
                    errors.jährlicheEinkünfte = true;
                    isValid = false;
                }

                if (!formData.monatlicheRücklage || isNaN(parseFloat(formData.monatlicheRücklage))) {
                    errors.monatlicheRücklage = true;
                    isValid = false;
                }
            } else if (currentStep === 3) {
                // Validate Step 3
                if (!formData.geschätzteRente || isNaN(parseFloat(formData.geschätzteRente))) {
                    errors.geschätzteRente = true;
                    isValid = false;
                }

                if (!formData.gewünschtesEinkommen || isNaN(parseFloat(formData.gewünschtesEinkommen))) {
                    errors.gewünschtesEinkommen = true;
                    isValid = false;
                }
            }

            // Display error messages
            const errorElements = document.querySelectorAll('.error-message');
            errorElements.forEach(el => {
                el.style.display = 'none';
            });

            Object.keys(errors).forEach(fieldName => {
                const errorElement = document.getElementById(`error-${fieldName}`);
                if (errorElement) {
                    errorElement.style.display = 'flex';
                    document.getElementById(fieldName).classList.add('error');
                }
            });

            return isValid;
        }

        // Navigation between steps
        function goToStep(step) {
            // Hide all steps
            document.querySelectorAll('.step-content').forEach(el => {
                el.classList.remove('active');
            });
            
            // Show current step
            document.getElementById(`step-${step}`).classList.add('active');
            
            // Update navigation buttons
            btnPrev.style.display = step > 1 ? 'block' : 'none';
            btnNext.textContent = step < totalSteps ? 'Weiter' : 'Ergebnisse anzeigen';
            
            // Update progress
            currentStep = step;
            updateProgress();
        }

        // Calculate retirement gap
        function calculateRetirementGap() {
            const monatlicheRente = parseFloat(formData.geschätzteRente) || 0;
            const gewünschtesEinkommen = parseFloat(formData.gewünschtesEinkommen) || 0;
            
            const rentenlücke = Math.max(0, gewünschtesEinkommen - monatlicheRente);
            const benötigtesKapital = rentenlücke * 12 * 25; // Faustregel: Jährlicher Bedarf x 25
            
            formData.rentenlücke = rentenlücke;
            formData.benötigtesKapital = benötigtesKapital;
        }

        // Calculate retirement strategy score
        function calculateVorsorgeScore() {
            let score = 0;
            
            // Gesetzliche Rente
            if (formData.versicherungsArt) score += 20;
            
            // Private Vorsorge
            if (formData.privateRente || formData.etfSparpläne || formData.rürupRente || formData.riesterRente) score += 20;
            
            // Betriebliche Vorsorge
            if (formData.direktversicherung || formData.unterstützungskasse || formData.pensionskasse || formData.versorgungswerk) score += 15;
            
            // Immobilien
            if (formData.wohneigentum || formData.vermietet) score += 15;
            
            // Sparquote
            const sparquote = getPercentage(formData.monatlicheRücklage, formData.jährlicheEinkünfte);
            if (sparquote >= 20) score += 20;
            else if (sparquote >= 10) score += 15;
            else if (sparquote >= 5) score += 5;
            
            // Steueroptimierung
            if (formData.höchstbeträgeAusgeschöpft) score += 10;
            
            return score;
        }

        // Calculate percentage of monthly savings compared to yearly income
        function getPercentage(monthly, yearly) {
            if (!monthly || !yearly) return 0;
            const monthlyValue = parseFloat(monthly);
            const yearlyValue = parseFloat(yearly);
            if (isNaN(monthlyValue) || isNaN(yearlyValue) || yearlyValue === 0) return 0;
            
            return Math.round((monthlyValue * 12 / yearlyValue) * 100);
        }

        // Display results
        function showResults() {
            // Calculate retirement gap and score
            calculateRetirementGap();
            const score = calculateVorsorgeScore();
            
            // Update situation list
            const situationList = document.getElementById('situation-list');
            situationList.innerHTML = '';
            
            if (formData.versicherungsArt) {
                addResultItem(situationList, `Rentenversicherung: ${formData.versicherungsArt}`);
            }
            
            if (formData.rentenHöhe) {
                addResultItem(situationList, `Erworbene Rente: ${parseFloat(formData.rentenHöhe).toLocaleString('de-DE')} €/Monat`);
            }
            
            if (formData.privateRente) {
                addResultItem(situationList, 'Private Rentenversicherung');
            }
            
            if (formData.etfSparpläne && formData.etfSparplanBetrag) {
                addResultItem(situationList, `ETF-/Fondssparpläne: ${parseFloat(formData.etfSparplanBetrag).toLocaleString('de-DE')} €/Monat`);
            }
            
            if (formData.rürupRente) {
                addResultItem(situationList, 'Rürup-Rente');
            }
            
            if (formData.riesterRente) {
                addResultItem(situationList, 'Riester-Rente');
            }
            
            if (formData.direktversicherung || formData.unterstützungskasse || formData.pensionskasse || formData.versorgungswerk) {
                addResultItem(situationList, 'Betriebliche Altersvorsorge');
            }
            
            if ((formData.wohneigentum || formData.vermietet) && formData.immobilienWert) {
                addResultItem(situationList, `Immobilienvermögen: ${parseFloat(formData.immobilienWert).toLocaleString('de-DE')} €`);
            }
            
            // Update gap results
            const gapResults = document.getElementById('gap-results');
            gapResults.innerHTML = `
                <p class="result-row"><span class="font-medium">Geschätzte monatliche Rente:</span> ${parseFloat(formData.geschätzteRente).toLocaleString('de-DE')} €</p>
                <p class="result-row"><span class="font-medium">Gewünschtes Einkommen:</span> ${parseFloat(formData.gewünschtesEinkommen).toLocaleString('de-DE')} €</p>
                <p class="result-row highlight">Monatliche Rentenlücke: ${formData.rentenlücke.toLocaleString('de-DE')} €</p>
                <p class="result-row highlight">Benötigtes Kapital: ${formData.benötigtesKapital.toLocaleString('de-DE')} €</p>
            `;
            
            // Update score
            document.getElementById('score-fill').style.width = `${score}%`;
            document.getElementById('score-percentage').textContent = `${score}%`;
            
            // Update strategy grid
            const strategyGrid = document.getElementById('strategy-grid');
            strategyGrid.innerHTML = '';
            
            // Gesetzliche Rente
            addStrategyItem(
                strategyGrid, 
                'Gesetzliche Rente',
                formData.versicherungsArt ? 'Vorhanden' : 'Prüfen',
                formData.versicherungsArt ? 'badge-green' : 'badge-yellow'
            );
            
            // Private Vorsorge
            addStrategyItem(
                strategyGrid,
                'Private Vorsorge',
                (formData.privateRente || formData.etfSparpläne || formData.rürupRente || formData.riesterRente) ? 'Vorhanden' : 'Empfohlen',
                (formData.privateRente || formData.etfSparpläne || formData.rürupRente || formData.riesterRente) ? 'badge-green' : 'badge-red'
            );
            
            // Betriebliche Vorsorge
            addStrategyItem(
                strategyGrid,
                'Betriebliche Vorsorge',
                (formData.direktversicherung || formData.unterstützungskasse || formData.pensionskasse || formData.versorgungswerk) ? 'Vorhanden' : 'Optional',
                (formData.direktversicherung || formData.unterstützungskasse || formData.pensionskasse || formData.versorgungswerk) ? 'badge-green' : 'badge-gray'
            );
            
            // Immobilienvermögen
            addStrategyItem(
                strategyGrid,
                'Immobilienvermögen',
                (formData.wohneigentum || formData.vermietet) ? 'Vorhanden' : 'Optional',
                (formData.wohneigentum || formData.vermietet) ? 'badge-green' : 'badge-gray'
            );
            
            // Sparquote
            const sparquote = getPercentage(formData.monatlicheRücklage, formData.jährlicheEinkünfte);
            addStrategyItem(
                strategyGrid,
                'Sparquote',
                formData.monatlicheRücklage ? `${sparquote}% vom Einkommen` : 'Zu niedrig',
                formData.monatlicheRücklage && sparquote >= 10 ? 'badge-green' : 'badge-red'
            );
            
            // Steuerliche Optimierung
            addStrategyItem(
                strategyGrid,
                'Steuerliche Optimierung',
                formData.höchstbeträgeAusgeschöpft ? 'Optimiert' : 'Potenzial',
                formData.höchstbeträgeAusgeschöpft ? 'badge-green' : 'badge-yellow'
            );
            
            // Update recommendations
            const recommendationList = document.getElementById('recommendation-list');
            recommendationList.innerHTML = '';
            
            if (!formData.versicherungsArt) {
                addRecommendation(recommendationList, 'Prüfen Sie Ihren Status bei der Deutschen Rentenversicherung und fordern Sie eine Renteninformation an.');
            }
            
            if (formData.versicherungsArt === 'Nicht versichert') {
                addRecommendation(recommendationList, 'Erwägen Sie eine freiwillige Einzahlung in die gesetzliche Rentenversicherung, um Basisschutz zu erhalten.');
            }
            
            if (!formData.privateRente && !formData.etfSparpläne && !formData.rürupRente && !formData.riesterRente) {
                addRecommendation(recommendationList, 'Bauen Sie eine private Altersvorsorge auf, z.B. mit ETF-Sparplänen oder einer Basisrente (Rürup).');
            }
            
            if (!formData.höchstbeträgeAusgeschöpft) {
                addRecommendation(recommendationList, 'Nutzen Sie steuerliche Vorteile durch Rürup-Rente oder freiwillige Einzahlungen in die DRV (bis zu 27.566 € bei Ledigen, 55.132 € bei Verheirateten in 2024).');
            }
            
            if (parseFloat(formData.monatlicheRücklage || 0) / (parseFloat(formData.jährlicheEinkünfte || 1) / 12) < 0.1 && formData.monatlicheRücklage && formData.jährlicheEinkünfte) {
                addRecommendation(recommendationList, 'Erhöhen Sie Ihre Sparquote auf mindestens 10-15% Ihres Einkommens für eine ausreichende Altersvorsorge.');
            }
            
            if (formData.rentenlücke > 500) {
                addRecommendation(recommendationList, 'Ihre Rentenlücke ist erheblich. Erwägen Sie, Ihre Vorsorgestrategie mit einem Finanzberater zu optimieren.');
            }
            
            addRecommendation(recommendationList, 'Überprüfen Sie Ihre Altersvorsorgestrategie mindestens einmal jährlich und passen Sie sie an veränderte Lebensumstände an.');
            
            // Show results container, hide form container
            formContainer.style.display = 'none';
            resultsContainer.style.display = 'block';
        }

        // Helper function to add result items
        function addResultItem(parentElement, text) {
            const item = document.createElement('li');
            item.className = 'flex items-start';
            item.innerHTML = `
                <i class="fas fa-check-circle text-green-500 mr-2 mt-1"></i>
                <span>${text}</span>
            `;
            parentElement.appendChild(item);
        }

        // Helper function to add strategy items
        function addStrategyItem(parentElement, title, status, statusClass) {
            const item = document.createElement('div');
            item.className = 'strategy-item';
            item.innerHTML = `
                <h4 class="strategy-title">${title}</h4>
                <span class="strategy-badge ${statusClass}">${status}</span>
            `;
            parentElement.appendChild(item);
        }

        // Helper function to add recommendations
        function addRecommendation(parentElement, text) {
            const item = document.createElement('li');
            item.innerHTML = `
                <i class="fas fa-arrow-right"></i>
                <span>${text}</span>
            `;
            parentElement.appendChild(item);
        }

        // Gather form data from inputs
        function gatherFormData() {
            // Gesetzliche Rentenversicherung
            formData.versicherungsArt = document.getElementById('versicherungsArt').value;
            formData.rentenHöhe = document.getElementById('rentenHöhe').value;
            formData.freiwilligeEinzahlung = document.getElementById('freiwilligeEinzahlung').checked;
            
            // Private Altersvorsorge
            formData.privateRente = document.getElementById('privateRente').checked;
            formData.privateRenteVerzinsung = document.getElementById('privateRenteVerzinsung').value;
            formData.privateRenteKosten = document.getElementById('privateRenteKosten').value;
            formData.etfSparpläne = document.getElementById('etfSparpläne').checked;
            formData.etfSparplanBetrag = document.getElementById('etfSparplanBetrag').value;
            formData.rürupRente = document.getElementById('rürupRente').checked;
            formData.riesterRente = document.getElementById('riesterRente').checked;
            
            // Betriebliche Altersvorsorge
            formData.direktversicherung = document.getElementById('direktversicherung').checked;
            formData.unterstützungskasse = document.getElementById('unterstützungskasse').checked;
            formData.pensionskasse = document.getElementById('pensionskasse').checked;
            formData.versorgungswerk = document.getElementById('versorgungswerk').checked;
            
            // Immobilien
            formData.wohneigentum = document.getElementById('wohneigentum').checked;
            formData.vermietet = document.getElementById('vermietet').checked;
            formData.immobilienWert = document.getElementById('immobilienWert').value;
            formData.kredite = document.getElementById('kredite').value;
            formData.mietrendite = document.getElementById('mietrendite').value;
            
            // Einnahmen & Steuer
            formData.jährlicheEinkünfte = document.getElementById('jährlicheEinkünfte').value;
            formData.monatlicheRücklage = document.getElementById('monatlicheRücklage').value;
            updateSteuerAbsetzung();
            formData.höchstbeträgeAusgeschöpft = document.getElementById('höchstbeträgeAusgeschöpft').checked;
            
            // Rentenlücke
            formData.geschätzteRente = document.getElementById('geschätzteRente').value;
            formData.gewünschtesEinkommen = document.getElementById('gewünschtesEinkommen').value;
        }

        // Event Listeners
        btnNext.addEventListener('click', () => {
            gatherFormData();
            
            if (validateCurrentStep()) {
                if (currentStep < totalSteps) {
                    goToStep(currentStep + 1);
                } else {
                    showResults();
                }
            }
        });

        btnPrev.addEventListener('click', () => {
            if (currentStep > 1) {
                goToStep(currentStep - 1);
            }
        });

        btnRestart.addEventListener('click', () => {
            // Reset form data
            formData = {
                versicherungsArt: '',
                rentenHöhe: '',
                freiwilligeEinzahlung: false,
                privateRente: false,
                privateRenteVerzinsung: '',
                privateRenteKosten: '',
                etfSparpläne: false,
                etfSparplanBetrag: '',
                rürupRente: false,
                riesterRente: false,
                direktversicherung: false,
                unterstützungskasse: false,
                pensionskasse: false,
                versorgungswerk: false,
                wohneigentum: false,
                vermietet: false,
                immobilienWert: '',
                kredite: '',
                mietrendite: '',
                jährlicheEinkünfte: '',
                monatlicheRücklage: '',
                steuerAbsetzung: [],
                höchstbeträgeAusgeschöpft: false,
                geschätzteRente: '',
                gewünschtesEinkommen: '',
                rentenlücke: 0,
                benötigtesKapital: 0
            };
            
            // Reset form elements
            document.getElementById('altersvorsorge-form').reset();
            
            // Hide conditional form elements
            document.getElementById('privateRenteDetails').style.display = 'none';
            document.getElementById('etfDetails').style.display = 'none';
            document.getElementById('immobilienDetails').style.display = 'none';
            document.getElementById('mietrenditeGroup').style.display = 'none';
            
            // Reset error messages
            const errorElements = document.querySelectorAll('.error-message');
            errorElements.forEach(el => {
                el.style.display = 'none';
            });
            
            // Reset input error classes
            const inputs = document.querySelectorAll('.form-input, .form-select');
            inputs.forEach(input => {
                input.classList.remove('error');
            });
            
            // Go back to step 1
            goToStep(1);
            
            // Show form container, hide results container
            formContainer.style.display = 'block';
            resultsContainer.style.display = 'none';
            
            // Reset sections
            document.querySelectorAll('.section-content').forEach(section => {
                if (section.id === 'section-gesetzlich') {
                    section.classList.add('active');
                    const header = document.querySelector(`[data-section="gesetzlich"]`);
                    header.querySelector('i:last-child').classList.replace('fa-chevron-down', 'fa-chevron-up');
                } else {
                    section.classList.remove('active');
                    const sectionId = section.id.replace('section-', '');
                    const header = document.querySelector(`[data-section="${sectionId}"]`);
                    if (header) {
                        header.querySelector('i:last-child').classList.replace('fa-chevron-up', 'fa-chevron-down');
                    }
                }
            });
            
            // Scroll to top
            window.scrollTo(0, 0);
        });

        // Initialize
        updateProgress();
    </script>
</body>
</html>
